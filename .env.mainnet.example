# ============================================================
# 8004 Solana Indexer (Mainnet Profile Template)
# ============================================================
#
# For a ready-to-run devnet profile (with startup cursor bootstrap),
# use .env.devnet.example.

# Database mode
# - supabase: use for GraphQL mode
# - local: use for REST mode
DB_MODE=supabase

# Supabase/PostgreSQL
SUPABASE_DSN=POSTGRES_DSN_REDACTED
SUPABASE_SSL_VERIFY=true
SUPABASE_URL=https://[project-ref].supabase.co
SUPABASE_KEY=service_role_key

# Local Prisma (REST mode)
# To run REST with local SQLite, switch DB mode to local and set DATABASE_URL.

# Solana network + RPC
# Allowed: devnet | mainnet-beta | testnet | localnet
# Used to derive RPC/WS defaults when RPC_URL/WS_URL are unset
SOLANA_NETWORK=mainnet-beta
RPC_URL=https://api.mainnet-beta.solana.com
WS_URL=wss://api.mainnet-beta.solana.com

# Program IDs (mainnet)
PROGRAM_ID=8oo4dC4JvBLwy5tGgiH3WwK4B9PWxL9Z4XjA2jzkQMbQ
ATOM_ENGINE_PROGRAM_ID=AToMw53aiPQ8j7iHVb4fGt6nzUNxUhcPc3tbPBZuzVVb

# Optional startup cursor bootstrap (recommended for first mainnet sync)
# INDEXER_START_SIGNATURE=<mainnet_deploy_tx_signature>
# INDEXER_START_SLOT=<mainnet_deploy_slot>

# API mode
# graphql | rest | both
# - graphql requires DB_MODE=supabase
# - rest requires DB_MODE=local OR DB_MODE=supabase with PostgREST proxy auth
#   (SUPABASE_URL+SUPABASE_KEY or POSTGREST_URL+POSTGREST_TOKEN)
# - both is best-effort: one side is disabled if its DB backend is unavailable
API_MODE=graphql
ENABLE_GRAPHQL=true
API_PORT=3001
# Cache TTL for globalStats/protocol aggregates (milliseconds)
GRAPHQL_STATS_CACHE_TTL_MS=60000

# Verification
VERIFICATION_ENABLED=true
VERIFY_INTERVAL_MS=60000
VERIFY_BATCH_SIZE=100
VERIFY_SAFETY_MARGIN_SLOTS=32

# Metadata extraction
INDEX_METADATA=normal
# Collection CID ingestion (c1:<cid> -> JSON standard fields)
INDEX_COLLECTION_METADATA=true
# IPFS gateway base used by URI digest + collection digest pointer fetches
IPFS_GATEWAY_BASE=https://ipfs.io
# Optional local-only SSRF override for tests (only localhost,127.0.0.1 are allowed)
# URI_DIGEST_TRUSTED_HOSTS=127.0.0.1,localhost
# Validation ingestion (archived module; disabled by default outside tests)
INDEX_VALIDATIONS=false
