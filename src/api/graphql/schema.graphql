scalar BigInt
scalar BigDecimal
scalar Bytes

enum AgentOrderBy {
  createdAt
  updatedAt
  totalFeedback
  qualityScore
  trustTier
}

enum FeedbackOrderBy {
  createdAt
  feedbackId
  value
  feedbackIndex
}

enum FeedbackResponseOrderBy {
  createdAt
  responseId
}

enum RevocationOrderBy {
  createdAt
  revocationId
  revokeCount
}

enum OrderDirection {
  asc
  desc
}

enum URIType {
  IPFS
  HTTP
  ARWEAVE
}

enum HashChainType {
  FEEDBACK
  RESPONSE
  REVOKE
}

input AgentFilter {
  id: ID
  id_in: [ID!]
  # Sequential DB registration id from agents.agent_id.
  agentId: BigInt
  # Legacy alias for agentId.
  agentid: BigInt
  owner: String
  owner_in: [String!]
  creator: String
  agentWallet: String
  totalFeedback_gt: BigInt
  totalFeedback_gte: BigInt
  createdAt_gt: BigInt
  createdAt_lt: BigInt
  updatedAt_gt: BigInt
  updatedAt_lt: BigInt
  collection: String
  collectionPointer: String
  parentAsset: String
  parentCreator: String
  atomEnabled: Boolean
  colLocked: Boolean
  parentLocked: Boolean
  trustTier_gte: Int
}

input FeedbackFilter {
  agent: ID
  feedbackId: BigInt
  feedbackId_gt: BigInt
  feedbackId_gte: BigInt
  feedbackId_lt: BigInt
  feedbackId_lte: BigInt
  clientAddress: String
  tag1: String
  tag2: String
  endpoint: String
  isRevoked: Boolean
  createdAt_gt: BigInt
  createdAt_lt: BigInt
}

input FeedbackResponseFilter {
  feedback: ID
  responseId: BigInt
  responseId_gt: BigInt
  responseId_gte: BigInt
  responseId_lt: BigInt
  responseId_lte: BigInt
  responder: String
  createdAt_gt: BigInt
  createdAt_lt: BigInt
}

input RevocationFilter {
  agent: ID
  revocationId: BigInt
  revocationId_gt: BigInt
  revocationId_gte: BigInt
  revocationId_lt: BigInt
  revocationId_lte: BigInt
  clientAddress: String
  feedbackIndex: BigInt
  createdAt_gt: BigInt
  createdAt_lt: BigInt
}

input AgentMetadataFilter {
  agent: ID
  key: String
}

input AgentRegistrationFileFilter {
  agent: ID
}

type Agent {
  id: ID!
  cursor: String!
  chainId: Int!
  # Sequential DB registration id from agents.agent_id (not asset-derived).
  agentId: BigInt!
  agentURI: String
  agentURIType: URIType
  owner: String!
  creator: String
  agentWallet: String
  collectionPointer: String
  colLocked: Boolean!
  parentAsset: String
  parentCreator: String
  parentLocked: Boolean!
  operators: [String!]!
  totalFeedback: BigInt!
  lastActivity: BigInt
  createdAt: BigInt!
  updatedAt: BigInt!
  registrationFile: AgentRegistrationFile
  feedback(
    first: Int = 100
    skip: Int = 0
    orderBy: FeedbackOrderBy
    orderDirection: OrderDirection
  ): [Feedback!]!
  metadata: [AgentMetadata!]!
  stats: AgentStats
  solana: SolanaAgentExtension
}

type Feedback {
  id: ID!
  cursor: String!
  agent: Agent!
  clientAddress: String!
  feedbackIndex: BigInt!
  value: BigDecimal!
  tag1: String
  tag2: String
  endpoint: String
  feedbackURI: String
  feedbackURIType: URIType
  feedbackHash: Bytes
  isRevoked: Boolean!
  createdAt: BigInt!
  revokedAt: BigInt
  responses(first: Int = 100, skip: Int = 0): [FeedbackResponse!]!
  solana: SolanaFeedbackExtension
}

type FeedbackResponse {
  id: ID!
  cursor: String!
  feedback: Feedback!
  responder: String!
  responseUri: String
  responseHash: Bytes
  createdAt: BigInt!
  solana: SolanaResponseExtension
}

type Revocation {
  id: ID!
  cursor: String!
  agent: Agent!
  clientAddress: String!
  feedbackIndex: BigInt!
  feedbackHash: Bytes
  originalScore: Int
  atomEnabled: Boolean!
  hadImpact: Boolean!
  createdAt: BigInt!
  solana: SolanaRevocationExtension
}

type AgentMetadata {
  id: ID!
  agent: Agent!
  key: String!
  value: String!
  updatedAt: BigInt
}

type AgentStats {
  id: ID!
  totalFeedback: BigInt!
  averageFeedbackValue: BigDecimal
  lastActivity: BigInt
}

type Protocol {
  id: ID!
  totalAgents: BigInt!
  totalFeedback: BigInt!
  tags: [String!]!
}

type GlobalStats {
  id: ID!
  totalAgents: BigInt!
  totalFeedback: BigInt!
  totalCollections: BigInt!
  tags: [String!]!
}

type AgentRegistrationFile {
  name: String
  description: String
  image: String
  active: Boolean
  x402Support: Boolean
  mcpEndpoint: String
  mcpTools: [String!]
  a2aEndpoint: String
  a2aSkills: [String!]
  oasfSkills: [String!]
  oasfDomains: [String!]
  hasOASF: Boolean
  supportedTrusts: [Int!]
}

type SolanaAgentExtension {
  assetPubkey: String!
  collection: String
  atomEnabled: Boolean!
  trustTier: Int
  qualityScore: Int
  confidence: Int
  riskScore: Int
  diversityRatio: Int
  verificationStatus: String
  feedbackDigest: String
  responseDigest: String
  revokeDigest: String
}

type SolanaFeedbackExtension {
  valueRaw: BigInt!
  valueDecimals: Int!
  score: Int
  runningDigest: String
  verificationStatus: String
  txSignature: String
  blockSlot: BigInt
}

type SolanaResponseExtension {
  runningDigest: String
  responseCount: BigInt
  verificationStatus: String
  txSignature: String
  blockSlot: BigInt
}

type SolanaRevocationExtension {
  runningDigest: String
  revokeCount: BigInt
  verificationStatus: String
  txSignature: String
  blockSlot: BigInt
}

type HashChainHead {
  digest: String
  count: BigInt!
}

type HashChainHeads {
  feedback: HashChainHead!
  response: HashChainHead!
  revoke: HashChainHead!
}

type HashChainCheckpoint {
  eventCount: BigInt!
  digest: String!
  createdAt: BigInt!
}

type HashChainCheckpointSet {
  feedback: HashChainCheckpoint
  response: HashChainCheckpoint
  revoke: HashChainCheckpoint
}

type HashChainReplayEvent {
  asset: String!
  client: String!
  feedbackIndex: BigInt!
  slot: BigInt!
  runningDigest: String
  feedbackHash: String
  responder: String
  responseHash: String
  responseCount: BigInt
  revokeCount: BigInt
}

type HashChainReplayPage {
  events: [HashChainReplayEvent!]!
  hasMore: Boolean!
  nextFromCount: BigInt!
}

type Collection {
  collection: String!
  creator: String!
  firstSeenAsset: String!
  firstSeenAt: BigInt!
  firstSeenSlot: BigInt!
  firstSeenTxSignature: String
  lastSeenAt: BigInt!
  lastSeenSlot: BigInt!
  lastSeenTxSignature: String
  assetCount: BigInt!
  version: String
  name: String
  symbol: String
  description: String
  image: String
  bannerImage: String
  socialWebsite: String
  socialX: String
  socialDiscord: String
  metadataStatus: String
  metadataHash: String
  metadataBytes: BigInt
  metadataUpdatedAt: BigInt
}

type AgentTreeNode {
  depth: Int!
  path: [String!]!
  parentAsset: String
  agent: Agent!
}

type Query {
  agent(id: ID!): Agent
  agents(
    first: Int = 100
    skip: Int = 0
    after: String
    where: AgentFilter
    orderBy: AgentOrderBy
    orderDirection: OrderDirection
  ): [Agent!]!
  feedback(id: ID!): Feedback
  feedbacks(
    first: Int = 100
    skip: Int = 0
    after: String
    where: FeedbackFilter
    orderBy: FeedbackOrderBy
    orderDirection: OrderDirection
  ): [Feedback!]!
  feedbackResponse(id: ID!): FeedbackResponse
  feedbackResponses(
    first: Int = 100
    skip: Int = 0
    after: String
    where: FeedbackResponseFilter
    orderBy: FeedbackResponseOrderBy
    orderDirection: OrderDirection
  ): [FeedbackResponse!]!
  revocation(id: ID!): Revocation
  revocations(
    first: Int = 100
    skip: Int = 0
    after: String
    where: RevocationFilter
    orderBy: RevocationOrderBy
    orderDirection: OrderDirection
  ): [Revocation!]!
  agentMetadatas(
    first: Int = 100
    skip: Int = 0
    where: AgentMetadataFilter
  ): [AgentMetadata!]!
  agentStats(id: ID!): AgentStats
  protocol(id: ID!): Protocol @deprecated(reason: "Use globalStats instead.")
  protocols(first: Int = 10, skip: Int = 0): [Protocol!]! @deprecated(reason: "Use globalStats instead.")
  globalStats: GlobalStats
  agentSearch(query: String!, first: Int = 20): [Agent!]!
  agentRegistrationFiles(
    first: Int = 100
    skip: Int = 0
    where: AgentRegistrationFileFilter
  ): [AgentRegistrationFile!]!
  hashChainHeads(agent: ID!): HashChainHeads!
  hashChainLatestCheckpoints(agent: ID!): HashChainCheckpointSet!
  hashChainReplayData(
    agent: ID!
    chainType: HashChainType!
    fromCount: BigInt = 0
    toCount: BigInt
    first: Int = 1000
  ): HashChainReplayPage!
  collections(
    first: Int = 100
    skip: Int = 0
    collection: String
    creator: String
  ): [Collection!]!
  agentChildren(
    parent: ID!
    first: Int = 100
    skip: Int = 0
  ): [Agent!]!
  agentTree(
    root: ID!
    maxDepth: Int = 5
    includeRoot: Boolean = true
    first: Int = 100
    skip: Int = 0
  ): [AgentTreeNode!]!
  collectionAssetCount(
    collection: String!
    creator: String
  ): BigInt!
  collectionAssets(
    collection: String!
    creator: String
    first: Int = 100
    skip: Int = 0
    orderBy: AgentOrderBy
    orderDirection: OrderDirection
  ): [Agent!]!
  agentLineage(
    asset: ID!
    includeSelf: Boolean = true
    first: Int = 100
    skip: Int = 0
  ): [Agent!]!

}
