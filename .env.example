# ============================================================
# 8004 Solana Indexer
# ============================================================

# Database mode
# - supabase: use for GraphQL mode
# - local: use for REST mode
DB_MODE=supabase

# Supabase/PostgreSQL
SUPABASE_DSN=POSTGRES_DSN_REDACTED
SUPABASE_SSL_VERIFY=true
SUPABASE_URL=https://[project-ref].supabase.co
SUPABASE_KEY=service_role_key

# Local Prisma (REST mode)
# DB_MODE=local
# DATABASE_URL=file:./data/indexer.db

# Solana network + RPC
# Allowed: devnet | mainnet-beta | testnet | localnet
# Used to derive RPC/WS defaults when RPC_URL/WS_URL are unset
SOLANA_NETWORK=devnet
RPC_URL=https://api.devnet.solana.com
WS_URL=wss://api.devnet.solana.com

# Program ID (defaults to devnet ID when unset)
PROGRAM_ID=8oo4J9tBB3Hna1jRQ3rWvJjojqM5DYTDJo5cejUuJy3C

# Mainnet example (uncomment and set your deployed program id)
# SOLANA_NETWORK=mainnet-beta
# RPC_URL=https://api.mainnet-beta.solana.com
# WS_URL=wss://api.mainnet-beta.solana.com
# PROGRAM_ID=<MAINNET_PROGRAM_ID>

# API mode
# graphql | rest | both
# - graphql requires DB_MODE=supabase
# - rest requires DB_MODE=local
# - both is best-effort: one side is disabled if its DB backend is unavailable
API_MODE=graphql
ENABLE_GRAPHQL=true
API_PORT=3001
# Cache TTL for globalStats/protocol aggregates (milliseconds)
GRAPHQL_STATS_CACHE_TTL_MS=60000

# Verification
VERIFICATION_ENABLED=true
VERIFY_INTERVAL_MS=60000
VERIFY_BATCH_SIZE=100
VERIFY_SAFETY_MARGIN_SLOTS=32

# Metadata extraction
INDEX_METADATA=normal
# Collection CID ingestion (c1:<cid> -> JSON standard fields)
INDEX_COLLECTION_METADATA=true
# Validation ingestion (archived module; disabled by default outside tests)
INDEX_VALIDATIONS=false
