# ============================================================
# 8004 Solana Indexer
# ============================================================
#
# For network-ready profiles, use:
# - .env.devnet.example
# - .env.mainnet.example

# Database mode
# - supabase: use for GraphQL mode
# - local: use for REST mode
DB_MODE=supabase

# Supabase/PostgreSQL
SUPABASE_DSN=POSTGRES_DSN_REDACTED
SUPABASE_SSL_VERIFY=true
SUPABASE_URL=https://[project-ref].supabase.co
SUPABASE_KEY=service_role_key

# Local Prisma (REST mode)
# To run REST with local SQLite, switch DB mode to local and set DATABASE_URL.

# Solana network + RPC
# Allowed: devnet | mainnet-beta | testnet | localnet
# Used to derive RPC/WS defaults when RPC_URL/WS_URL are unset
SOLANA_NETWORK=devnet
RPC_URL=https://api.devnet.solana.com
WS_URL=wss://api.devnet.solana.com

# Program ID (defaults to devnet ID when unset)
PROGRAM_ID=8oo4J9tBB3Hna1jRQ3rWvJjojqM5DYTDJo5cejUuJy3C
ATOM_ENGINE_PROGRAM_ID=AToMufS4QD6hEXvcvBDg9m1AHeCLpmZQsyfYa5h9MwAF

# Optional startup cursor bootstrap (used only if no saved indexer_state exists)
# INDEXER_START_SIGNATURE=<tx_signature>
# INDEXER_START_SLOT=<slot_number>

# Mainnet profile lives in `.env.mainnet.example`.

# API mode
# graphql | rest | both
# - graphql requires DB_MODE=supabase
# - rest requires DB_MODE=local OR DB_MODE=supabase with PostgREST proxy auth
#   (SUPABASE_URL+SUPABASE_KEY or POSTGREST_URL+POSTGREST_TOKEN)
# - both is best-effort: one side is disabled if its DB backend is unavailable
API_MODE=graphql
ENABLE_GRAPHQL=true
API_PORT=3001
# Cache TTL for globalStats/protocol aggregates (milliseconds)
GRAPHQL_STATS_CACHE_TTL_MS=60000

# Verification
VERIFICATION_ENABLED=true
VERIFY_INTERVAL_MS=60000
VERIFY_BATCH_SIZE=100
VERIFY_SAFETY_MARGIN_SLOTS=32

# Metadata extraction
INDEX_METADATA=normal
# Collection CID ingestion (c1:<cid> -> JSON standard fields)
INDEX_COLLECTION_METADATA=true
# IPFS gateway base used by URI digest + collection digest pointer fetches
IPFS_GATEWAY_BASE=https://ipfs.io
# Optional local-only SSRF override for tests (only localhost,127.0.0.1 are allowed)
# URI_DIGEST_TRUSTED_HOSTS=127.0.0.1,localhost
# Validation ingestion (archived module; disabled by default outside tests)
INDEX_VALIDATIONS=false
